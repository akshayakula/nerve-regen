# Hand Tracking Web App - Developer Specification

## Project Overview:
You are building a **React web application** that:
1. **Collects user data** (name, medical questions) via a **wizard-style form**.
2. **Captures webcam input** and feeds it into the **Handpose model** from **TensorFlow.js** to track the user's hand and wrist movements.
3. **Processes the hand movement data** alongside input from an **Arduino device**.
4. **Stores all collected data** (medical details, hand tracking data) in a **NoSQL database** for later processing and use.

---

## Architecture Choices:

### 1. Front-End:
- **React**: The primary framework for building the user interface.
- **ShadCN**: UI component library for clean, consistent form elements and buttons.
- **TensorFlow.js**: To run the **Handpose model** for hand tracking directly in the browser.
- **State Management**: Use **React's useState** to manage form data and application state.
- **Styling**: Use **Tailwind CSS** (via ShadCN) for responsive and efficient styling.
- **Webcam Capture**: Utilizes **`navigator.mediaDevices.getUserMedia`** to stream video from the user's camera.
- **Progress Bar**: A progress indicator is implemented to show the user how far they are in the form.

### 2. Back-End:
- **Node.js**: To handle **server-side ML processing** (TensorFlow.js model), process data from the **Arduino device**, and interact with the **database**.
- **Arduino**: Will communicate with the Node.js server via **Serial Communication** or **WebSockets**, sending sensor data (e.g., EMG) to be processed on the server.
- **Database**: Use a **NoSQL database** (e.g., **MongoDB**) for storing:
  - **User medical information** (name, hand dominance, treatment, symptoms).
  - **Hand tracking data** (wrist position, angles, landmarks).
  - **Sensor data from Arduino** (milliAmps, Volts, Hertz, Frequency).

### 3. Communication:
- **Front-End to Back-End**: The React app will send webcam data (hand pose landmarks) and user medical data to the Node.js server.
- **Back-End to Arduino**: The server will communicate with the Arduino via **Serial Communication** or **WebSocket** to receive sensor data and send commands to the hardware if needed.

---

## Data Handling:

### 1. Data Collection:
- **User Medical Data** (form-based):
  - **Age**
  - **Hand dominance (left/right)**
  - **Current treatment for Parkinson's**
  - **When symptoms began**

- **Hand Tracking Data** (from Handpose model):
  - **Hand and wrist positions**
  - **Joint angles** (wrist flexion, hand rotation)
  - **Timestamps**
  - **Additional features**: If applicable, store additional information like joint velocities, distances, etc.

- **Arduino Sensor Data**:
  - **milliAmps**
  - **Volts**
  - **Hertz**
  - **Frequency**
  - **electrode_id**

### 2. Data Storage:
- **Database Schema** (NoSQL, MongoDB):
  - **User Data**:
    - `user_id` (auto-generated by backend)
    - `name` (string)
    - `hand_dominance` (string)
    - `treatment_for_parkinsons` (boolean)
    - `symptom_start_date` (string)
  - **Hand Tracking Data**:
    - `user_id` (foreign key)
    - `timestamp` (ISO date)
    - `hand_position` (array of coordinates)
    - `wrist_position` (array of coordinates)
    - `joint_angles` (object with joint names and angles)
  - **Sensor Data**:
    - `user_id` (foreign key)
    - `milliAmps` (float)
    - `Volts` (float)
    - `Hertz` (float)
    - `Frequency` (float)
    - `electrode_id` (string)

---

## Error Handling Strategies:

### 1. Front-End Error Handling:
- **Form Validation**:
  - Ensure that all required fields are filled in before submission.
  - Display **error messages** for missing inputs or invalid formats (e.g., invalid date format for symptom start date).
- **Webcam Issues**:
  - If the webcam fails to load or is unavailable, display a **friendly error message** informing the user.
- **Handpose Model Errors**:
  - If Handpose fails to detect the hand or if there is a **model loading failure**, display a **fallback message** prompting the user to try again.

### 2. Back-End Error Handling:
- **Input Validation**:
  - Ensure all incoming data from the front-end (medical information, hand pose data) is valid before processing or saving to the database.
- **Arduino Communication Errors**:
  - Handle possible disconnections or communication issues with the Arduino. If data cannot be read from the Arduino, send a **reconnect attempt** and log the issue.
- **Database Errors**:
  - Handle database connection issues gracefully by retrying the connection or sending an **error response** back to the client with a relevant message.

---

## Testing Plan:

### 1. Unit Tests:
- **React Components**: Test the **input forms** (name, hand dominance, etc.), and **progress bar** rendering to ensure proper functionality.
- **TensorFlow.js Integration**: Ensure that Handpose is correctly loading and providing hand landmarks in real-time (for both webcam feed and video processing).
- **Database Operations**: Test data insertion and retrieval in the **NoSQL database**, ensuring data integrity and the ability to query based on user IDs, timestamps, etc.
- **Arduino Communication**: Test the **serial communication** with the Arduino to ensure data is being sent and received correctly.

### 2. Integration Tests:
- **Frontend and Backend**: Test the **full flow** from form submission (React front-end) to data storage (Node.js and MongoDB) to ensure everything is integrated and functional.
- **End-to-End**: Test the entire system, from the **webcam capture** to **Handpose processing**, **database storage**, and **Arduino communication**, ensuring the entire system works in harmony.

### 3. Performance Testing:
- **Front-End Performance**: Test how well **TensorFlow.js** performs on different devices (desktop vs mobile). Track the **frame rate** and ensure the webcam feed processing does not cause **significant lag**.
- **Back-End Performance**: Test how the server handles multiple users simultaneously sending webcam data, Arduino inputs, and querying the database.
- **Database Load**: Test the systemâ€™s ability to handle large volumes of data (e.g., multiple users submitting data, high-frequency sensor data).

---

## Next Steps:
1. **Set up the React app with ShadCN** and integrate the form and progress bar components.
2. **Set up the backend** with Node.js to process the Handpose data and communicate with the Arduino.
3. **Implement database** schema for storing user and sensor data.
4. **Test the system** with the steps outlined above.

---

## Step-by-Step Iterative Chunks

### **Step 1: Set Up React App & ShadCN**
**Goal:** Set up the React project with **ShadCN** for UI components.
- **Action:** 
    1. Create React app.
    2. Install ShadCN and Tailwind CSS.
    3. Verify a working button component from ShadCN.

#### **Prompt 1: Set Up React App with ShadCN**
```markdown
1. Create React App:
   ```bash
   npx create-react-app hand-tracking-app
   cd hand-tracking-app